\documentclass[a4paper]{article}

% --- Page layout and spacing ---
\usepackage[top=3cm, left=3.5cm, right=3.5cm, bottom=3cm]{geometry}
\usepackage[utf8]{inputenc}      % input encoding
\usepackage[T1]{fontenc}         % font encoding
\usepackage[english]{babel}
\usepackage{setspace}
\setlength{\parindent}{0pt}      % paragraph indentation
\setlength{\parskip}{0.8em}      % space between paragraphs
\setstretch{1.2}                 % line spacing
\usepackage{tocloft}             % section spacing in ToC
\setlength{\cftbeforesecskip}{10pt}
\setlength{\cftbeforesubsecskip}{4pt}
\usepackage{titlesec}            % section title spacing
\titlespacing*{\section}{0pt}{5.0ex plus 1ex minus .2ex}{1.0ex plus .2ex}
\titlespacing*{\subsection}{0pt}{3.0ex plus .5ex minus .2ex}{0.8ex plus .2ex}
\titlespacing*{\subsubsection}{0pt}{2.0ex plus .5ex minus .2ex}{0.8ex plus .2ex}

% --- Math and symbols ---
\usepackage{amsmath, amssymb}    % standard math
\usepackage{empheq}              % boxed equations etc.
\DeclareMathOperator{\artanh}{artanh}
\DeclareMathOperator{\sgn}{sgn}
\usepackage{bm}                  % bold math symbols
\usepackage{cancel}              % strikeout in math
\usepackage{siunitx}             % proper units
\DeclareSIUnit\angstrom{\text{Å}}
\renewcommand{\arraystretch}{0.7}

% --- Graphics and floats ---
\usepackage{graphicx}
\usepackage{float}
\usepackage{wrapfig}
\usepackage[justification=centering]{caption}
\usepackage{subcaption}
\captionsetup[figure]{font=small}

% --- Layout helpers ---
\usepackage{boxedminipage}
\usepackage{enumitem}
\usepackage{afterpage}
\usepackage{changepage}
\usepackage{pdfpages}           % include external PDFs
\usepackage{esvect}             % nice vector arrows
\usepackage{hyperref}           % hyperlinks

% --- Bibliography setup ---
\usepackage{csquotes}
\usepackage[backend=biber,style=numeric,sorting=none]{biblatex}
\addbibresource{references.bib}

% --- Fonts ---
\usepackage{lmodern}            % Computer Modern look across TeX distros


\begin{document}


% --- Title page ---
\begin{titlepage}
\thispagestyle{empty}
\begin{center}

% Title
\vspace*{1cm}
{\LARGE \textbf{Scanning Tunneling Microscope}}\\[1.2cm]

% Subtitle
{\large Evaluation Report}\\[2cm]

% Authors
\large
\textbf{Cem Boyaci}\\[-1mm]
{cemb93@zedat.fu-berlin.de}\\[1cm]

\textbf{Javier Bellido Roldán}\\[-1mm]
{bellidoroj98@zedat.fu-berlin.de}\\[1cm]

\textbf{Leon Goldammer}\\[-1mm]
{lg4278fu@zedat.fu-berlin.de}\\[6cm]

% Tutor
\normalsize
{Tutor: Vibhuti Rai}\\[1.2cm]

% Footer block
\textbf{Fortgeschrittenenpraktikum, WS 2025/2026}\\
Berlin, 03.12.2025\\
Freie Universität Berlin\\
Fachbereich Physik

\end{center}
\end{titlepage}



% --- Table of contents ---
\clearpage
\renewcommand*\contentsname{\huge Contents}
{
  \pagenumbering{gobble}
  \tableofcontents
  \clearpage
}
\pagenumbering{arabic}



% --- Introduction ---
\newpage
\setcounter{page}{1} 

\section{Introduction}

The scanning tunneling microscope (STM) is a surface–analysis technique that enables real–space imaging of conductive materials with sub–nanometer resolution.
It operates by positioning a sharp metallic tip a few ångströms above the sample surface and detecting the tunneling current that flows when a bias voltage is applied.
Because this current is extremely sensitive to the tip–sample distance, the STM can resolve atomic–scale height variations and visualize the topography and electronic structure of surfaces.
In this experiment we use a tabletop STM operated under ambient conditions to record and analyze surface images of highly oriented pyrolytic graphite (HOPG).
The aim is to become familiar with the operating principles of STM and to extract structural information from the acquired images.



% --- Physical Principles ---
\section{Physical Principles}

\subsection{Quantum Tunneling}

To understand the origin of the tunneling current, it is helpful to recall a few basic ideas from quantum mechanics.
Electrons in atoms occupy discrete orbitals whose spatial shape is described by a wavefunction.
A familiar introductory model is an electron encountering a finite potential barrier, where the wavefunction remains oscillatory inside the material but does not vanish abruptly at the boundary.
Instead, it decays exponentially into the classically forbidden region.
A similar exponential decay $\psi = \psi_0 \exp(-\chi z)$ occurs at the surface of a solid, where the periodic crystal potential ends and the electron encounters empty space.
The decay constant $\chi$ depends on how strongly the electron is bound and therefore determines how far different states extend into the vacuum.

Tunneling becomes relevant only when another conductive object is brought extremely close to the surface.
If the separation between the surface and the STM tip is only a few ångströms, the exponentially decaying wavefunctions of the two sides overlap (Fig.~\ref{fig:stm_wavefunction_overlap}).
In this situation an electron has a finite probability to appear on the other side of the gap, even though it cannot cross classically.
Because the probability depends exponentially on the separation, even tiny changes in distance cause large changes in the tunneling current~\cite{STMAnleitung}.

\vspace{1em}
\begin{figure}[H]
\centering
\includegraphics[width=0.73\textwidth]{../resources/figures/STM_Tunneling_Schematic.png}
\caption{Schematic illustration of how tunneling becomes possible when the wavefunctions of the surface electrons $\psi_s$ and those of the STM tip $\psi_t$ overlap across the narrow gap~\cite{UW_AFM_STM_Workshop}.}
\label{fig:stm_wavefunction_overlap}
\end{figure}


\subsection{Fermi Levels, Work Functions, and Bias Voltage}

To understand what drives electrons across the tunneling gap, it is useful to look at how the energy levels of the tip and the sample are arranged.
Every conductor has a Fermi energy $E_F$, which marks the energy up to which electronic states are filled at zero temperature.
Each material also has a work function $\Phi$, which is the energy required to remove an electron from the Fermi level into the vacuum.
Because the tip and the sample are made of different materials, their work functions may not be equal (see Fig.~\ref{fig:energy_band_diagrams}a).

If the two conductors are electrically connected without any applied voltage, electrons can flow freely between them until they reach equilibrium.
In this equilibrium state their electrochemical potentials, and therefore their Fermi levels, must align, as sketched in Fig.~\ref{fig:energy_band_diagrams}b.
The vacuum levels, however, remain offset by the difference in work function.

\vspace{1em}
\begin{figure}[H]
\centering
\includegraphics[width=0.72\textwidth]{../resources/figures/energy_band_diagrams_1.png}
\caption{
Energy level diagrams under different conditions.
(a) Independent tip and sample with their respective work functions $\Phi_T$ and $\Phi_S$.
(b) After contact the Fermi levels align in equilibrium.
}
\label{fig:energy_band_diagrams_1}
\end{figure}

When a bias voltage $V$ is applied between tip and sample, this equilibrium is disturbed.
The applied voltage shifts the electronic energies of one side relative to the other by an amount $eV$.
Figures~\ref{fig:energy_band_diagrams}c and~\ref{fig:energy_band_diagrams}d show how this shift opens an energy window that allows electrons to tunnel.
If the sample is held at a positive voltage, its electronic states are shifted downward by $eV$, so that electrons from the tip can tunnel into empty states of the sample.
If the sample is held at a negative voltage, the situation reverses and electrons tunnel from the sample into the tip.
In this sense the STM “probes’’ the part of the electronic structure that becomes available within the energy window created by the applied voltage. 

\vspace{1em}
\begin{figure}[H]
\centering
\includegraphics[width=0.72\textwidth]{../resources/figures/energy_band_diagrams_2.png}
\caption{
(c) A positive sample bias lowers the sample’s energy levels by $eV$, enabling tunneling from the tip into unoccupied sample states.
(d) A negative sample bias raises the sample’s states, so electrons tunnel from the sample into the tip.
Adapted from~\cite{morgenstern_stm_rub}.
}
\label{fig:energy_band_diagrams}
\end{figure}


\subsection{Principle of STM Operation}

Once the tip is brought close enough for tunneling to occur, a bias voltage is applied between the tip and the sample.
This voltage creates the energy window through which electrons can tunnel, as described in the previous subsection.
The resulting tunneling current depends extremely sensitively on the tip–sample separation $z$ and can be approximated as
\begin{equation}
I_t \sim V_t \exp\!\big(-c\,\sqrt{\Phi}\, z\big)
\label{eq:simple_current}
\end{equation}
where $V_t$ is the applied bias voltage, $\Phi$ is an effective barrier height, and $c$ is a constant containing the relevant physical constants~\cite{STMAnleitung}.
This exponential form arises from solving the Schrödinger equation for an electron tunneling through a finite vacuum barrier, exactly the same model introduced earlier for the exponential decay of the wavefunction.
Because of the exponential dependence on $z$, even sub-ångström changes in distance lead to large variations in the tunneling current.

To record an image, the STM moves the tip laterally while either keeping the height fixed or adjusting it continuously, as illustrated in Fig.~\ref{fig:stm_scan_modes}.
In constant–height mode the tip position $z$ remains fixed, and contrast arises solely from variations in the tunneling current.
This mode is fast but only safe on atomically flat surfaces, since the tip may collide with protrusions on the sample.

In constant–current mode, which is used in this experiment, the STM continuously adjusts the tip height so that the tunneling current matches a chosen setpoint.
A feedback loop monitors the current in real time and moves the tip up or down using a piezoelectric actuator whenever the measured current deviates from this value.
The vertical motion required to maintain the setpoint current is recorded and interpreted as the apparent surface topography.

\vspace{1em}
\begin{figure}[H]
\centering
\includegraphics[width=1.0\textwidth]{../resources/figures/STM_Modes.png}
\caption{Basic working principle of STM imaging.
(a) Constant–height mode, where the tip follows a fixed distance while the tunneling current varies with the surface, which risks tip crash on rough samples.
(b) Constant–current mode, where a feedback loop adjusts the tip height to maintain a constant current.
The recorded height forms the STM image~\cite{huda2016thesis}.}
\label{fig:stm_scan_modes}
\end{figure}

Because the measurement in constant–current mode relies on maintaining a constant tunneling probability, the STM image essentially represents the height at which the electronic density accessible for tunneling matches the selected setpoint.
This explains why STM images are strongly influenced by the electronic structure of the surface and not solely by its geometric topography.
This connection becomes clearer when we look more closely at the expression for the tunneling current.


\subsection{The Tunneling Current}

A more complete description of the tunneling current must account for three ingredients:
(1) how many electronic states exist at each energy on both sides of the gap,\\
(2) how strongly these states are occupied, and\\
(3) how likely it is for an electron of a given energy to cross the vacuum barrier.\\
These are described respectively by the densities of states, the Fermi--Dirac occupations, and the tunneling probability.

The density of states $\rho(E)$ specifies how many electronic states are available per energy interval at energy $E$.
In STM one often uses the local density of states (LDOS), which gives the number of states at a given energy and at the position where the tip samples the surface.

The occupation of states at finite temperature is given by the Fermi--Dirac distribution,

\[
f(E) = \frac{1}{1 + \exp\!\big((E - E_F)/k_\mathrm{B}T\big)} \, ,
\]

where $E_F$ is the Fermi energy and $k_\mathrm{B}$ is Boltzmann’s constant.
Electrons---like all fermions with half-integer spin, such as protons and neutrons---obey this distribution because they are subject to the Pauli exclusion principle, which permits at most one occupied state per spin at each energy.
Bosons (such as photons) do not obey this rule and can occupy the same state in unlimited numbers.

Pauli exclusion forces electrons to fill all available low-energy states first and creates the sharp boundary at $E_F$ that separates predominantly filled from predominantly empty states.
At $T=0$ the function is a perfect step: $f(E)=1$ for $E<E_F$ (filled states) and $f(E)=0$ for $E>E_F$ (empty states).
At room temperature the step becomes slightly smeared but still remains very sharp on the scale of typical electronic energies.

\vspace{1em}
\begin{figure}[H]
\centering
\includegraphics[width=1.0\textwidth]{../resources/figures/fermi_dirac.png}
\caption{
Fermi--Dirac distribution at several temperatures, showing the sharp transition between filled states ($E<E_F$) and empty states ($E>E_F$).
Adapted from~\cite{doitpoms_fermi}.
}
\label{fig:fermi_dirac}
\end{figure}

The third ingredient is the tunneling probability $T(E,V)$, which describes how likely it is for an electron with energy $E$ to traverse the barrier separating tip and sample.
Solving the Schrödinger equation for a simple one-dimensional potential barrier shows that $T(E,V)$ decreases exponentially with both the width of the barrier and with $\sqrt{\Phi}$, where $\Phi$ is the relevant barrier height.
This exponential sensitivity is the origin of the strong distance dependence that appears in the simplified tunneling-current expression Eq.~\eqref{eq:simple_current}.

Once these ingredients are known, the tunneling current can be written schematically as

\[
I(V) \propto
\int \rho_s(E) \; \rho_t(E-eV) \;
[f_s(E) - f_t(E-eV)] \; T(E,V) \; dE \, ,
\]

where $\rho_s$ and $\rho_t$ are the densities of states of sample and tip, and $f_s$ and $f_t$ are their respective Fermi--Dirac occupations.
The factor $f_s(E) - f_t(E-eV)$ ensures that electrons tunnel only from filled states into empty ones.
The densities of states determine how many such states are available at each energy, and the tunneling probability drops so rapidly with distance that only electrons from very close tip positions contribute.

At low temperatures the Fermi functions are nearly step-like, so the integrand is nonzero only within a narrow energy window of width $eV$.
In this limit one may approximate

\[
I(V) \propto \int_{E_F}^{E_F + eV}
\rho_s(E) \; \rho_t(E-eV) \; T(E,V) \; dE \, .
\]

This form makes it clear that, for a positive sample bias, only electronic states between $E_F$ and $E_F+eV$ contribute to the current.
Because the LDOS of the surface directly influences the number of available states in this energy window, STM images reflect both the geometric and the electronic structure of the sample near the Fermi level.

Much of the qualitative understanding of these relationships was also conveyed during the laboratory discussion with our tutor, who explained the underlying concepts using the STM theory slides provided in the course~\cite{rai_stm_slides}.


\subsection{Electronic Structure of Solids and Graphite}

To understand which electrons contribute to the tunneling current, we need to consider how electrons behave in solids.
When many atoms join to form a crystal, their atomic orbitals overlap and broaden into energy bands.
The highest fully occupied band is the valence band, while higher–energy states form the conduction band.
In conductors these bands touch or overlap at the Fermi level, so electronic states are available for transport even without thermal excitation.

Graphite is an example of such a conductor.
Each carbon atom contributes four valence electrons, which in the isolated atom occupy the configuration $1s^2\,2s^2\,2p^2$, but in the solid adopt a different bonding arrangement.
In the planar geometry of a graphene sheet, three of these electrons hybridize into sp$^2$ orbitals that form strong in–plane $\sigma$ bonds.
The remaining electron occupies a $p_z$ orbital that points perpendicular to the plane.
Together this corresponds to an $(\mathrm{sp}^2)^3 p_z$ configuration for carbon in graphite.

Neighbouring $p_z$ orbitals overlap to form a delocalized $\pi$ band that crosses the Fermi level and provides the electrical conductivity of graphite (Fig.~\ref{fig:carbon_bonding}).
Because the $\pi$ electrons are the least tightly bound and extend farthest into the vacuum, they dominate the tunneling process.
The STM is therefore primarily sensitive to the spatial distribution of these $\pi$ states rather than to the atomic nuclei themselves.

\vspace{1em}
\begin{figure}[H]
\centering
\includegraphics[width=1.0\textwidth]{../resources/figures/Carbon_Bonding.png}
\caption{Electronic orbitals in a graphene layer.
Each carbon atom forms three in-plane $\sigma$ bonds through sp$^2$ hybrid orbitals, while the $p_z$ orbitals extend perpendicular to the sheet and form the delocalized $\pi$ system.
These out-of-plane $\pi$ electrons dominate the tunneling current in STM~\cite{proctor2019aps}.}
\label{fig:carbon_bonding}
\end{figure}

At the surface the $\pi$ electron density does not end abruptly but decays gradually into the vacuum.
The amount of electron density above each atomic site depends on how the $p_z$ orbitals overlap with those of neighbouring atoms and with deeper layers.
This variation is described by the local density of states (LDOS), which determines how much tunneling current can flow at a given position.
Regions of higher LDOS allow a stronger tunneling current, so the STM image reflects the electronic structure of the surface, leading to the characteristic atomic–resolution contrast observed in graphite.


\subsection{Highly Oriented Pyrolytic Graphite (HOPG)}

The sample material used in this experiment is \emph{highly oriented pyrolytic graphite} (HOPG).
HOPG is a synthetic form of graphite composed of many graphene layers that are very well aligned with each other.
This strong alignment leads to large, flat surface regions with a well-defined hexagonal lattice.

A major practical advantage of HOPG is that it can be easily cleaved using adhesive tape.
Cleaving exposes a fresh surface with atomically flat graphene terraces that are electrically conductive and stable under ambient conditions.
This makes it ideally suited for STM measurements without the need for a vacuum.
Because its lattice structure and electronic properties are well known, HOPG serves as a standard reference sample in STM~\cite{spmtips_hopg}.


\subsection{Atomic Contrast and Lattice Geometry in Graphite}

Atomic–resolution STM images of graphite famously show a triangular pattern in which only every second atom appears bright.
In the early days of STM this was puzzling, because the carbon atoms in graphene form a perfectly symmetric honeycomb lattice, and the measured contrast did not match this expected geometry~\cite{atamny1999pccp}.
The explanation lies in how the real–space lattice of graphene combines with the periodicity of its electronic states, which becomes especially clear when viewed in reciprocal space through the Fourier transform of STM images.

\subsubsection{Real–Space Structure and Sublattice Contrast}

Although STM probes real surfaces, the tunneling current reflects the local density of states rather than the exact nuclear positions.
To understand the contrast on graphite, it is therefore natural to begin with the geometry of a single graphene layer, whose atomic arrangement and out–of–plane $\pi$ orbitals determine how much electronic density reaches the tip.

\vspace{1em}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.98\textwidth]{../resources/figures/graphene_lattice.png}
    \caption{
        Real–space geometry of graphene using a coordinate system with the origin at a hexagon centre.
        The primitive vectors $\vec a_1$ and $\vec a_2$ connect neighbouring hexagon centres and span the triangular (or hexagonal) Bravais lattice.
        The primitive cell contains two carbon atoms, $A$ and $B$, separated by one carbon–carbon bond length $a_{\mathrm{CC}}$.
        Replication of this cell generates the honeycomb structure.
        Figure created by the author.
    }
    \label{fig:graphene_lattice}
\end{figure}

Graphene is not a Bravais lattice by itself but a \emph{triangular} (also called \emph{hexagonal}) Bravais lattice with a two–atom basis~\cite{wikipedia_hexagonal_lattice}.
A convenient choice of coordinate system, as used in Fig.~\ref{fig:graphene_lattice}, places the origin at the centre of a hexagon, where no atom is located.  
From this point the primitive lattice vectors
\[
\vec a_1 = \left( \tfrac{3}{2}a_{\mathrm{CC}},\;\tfrac{\sqrt{3}}{2}a_{\mathrm{CC}} \right),
\qquad
\vec a_2 = \left( \tfrac{3}{2}a_{\mathrm{CC}},\; -\tfrac{\sqrt{3}}{2}a_{\mathrm{CC}} \right)
\]
connect the centres of neighbouring hexagons.  
Their length,
\[
|\vec a_1| = |\vec a_2| = \sqrt{3}\,a_{\mathrm{CC}} \approx 2.46~\text{\AA},
\]
is the lattice constant of the triangular Bravais lattice, expressed in terms of the nearest–neighbour carbon–carbon distance $a_{\mathrm{CC}} = 1.42~\text{\AA}$~\cite{STMAnleitung}.

Within each primitive cell spanned by $\vec a_1$ and $\vec a_2$ lie two carbon atoms, labelled $A$ and $B$ in the figure.  
In this coordinate system their positions are especially simple:
\[
\tau_A = (a_{\mathrm{CC}}, 0),
\qquad
\tau_B = (2a_{\mathrm{CC}}, 0),
\]
so that the two atoms in the basis are separated by exactly one nearest–neighbour bond length.  
Replicating this primitive cell across the plane generates the familiar honeycomb arrangement of carbon atoms, shown by the purple bonds in the figure.  

This real–space lattice structure directly influences STM contrast.  
Because the STM measures the local density of electronic states rather than the positions of the atomic nuclei, only atoms whose out–of–plane $\pi$ orbitals extend strongly into the vacuum contribute a large tunneling current.

In graphite, which consists of graphene layers in AB (Bernal) stacking, this leads to a sublattice asymmetry: one of the two atoms in the basis sits above a carbon atom in the layer below and hybridizes more strongly, while the other sits above a hollow site and retains a larger $\pi$ amplitude at the surface.  
Consequently, only every second atom appears bright in typical STM images of graphite, even though the underlying atomic lattice is perfectly hexagonal. This can be seen in Fig.~\ref{fig:graphite_stacking}.

\vspace{1em}
\begin{figure}[H]
\centering
\includegraphics[width=0.7\textwidth]{../resources/figures/Graphite_Stacking.png}
\caption{
AA and AB stacking in graphite.
In AB stacking, half of the surface atoms lie above atoms in the layer below ($\alpha$ sites) while the others lie above hollow sites ($\beta$ sites), leading to different LDOS contributions in STM~\cite{birowska2011graphite}.
}
\label{fig:graphite_stacking}
\end{figure}

\subsubsection{Reciprocal-Space Structure and the Fourier Transform of STM Images}

Atomic-resolution STM images of graphite contain not only real-space contrast but also clear periodic signatures in reciprocal space.
Taking the two-dimensional Fourier transform (FFT) of such an image produces a pattern of six bright peaks arranged in a hexagon.
These peaks arise because any periodic lattice has a corresponding reciprocal lattice that encodes its spatial frequencies.

\vspace{5em}
\begin{figure}[H]
    \centering
    \includegraphics[width=1.0\textwidth]{../resources/figures/graphene_reciprocal.png}
    \caption{
        Real and reciprocal lattice of graphene.
        The real lattice is generated by the primitive vectors $\vec a_1$ and $\vec a_2$.
        The reciprocal lattice consists of points (green circles) obtained from the reciprocal vectors $\vec b_1$ and $\vec b_2$.
        The six nearest reciprocal lattice points form the central hexagon, exactly the pattern that appears in the FFT of an STM topograph.
        Adapted from~\cite{raj2019phonon}.
    }
    \label{fig:graphene_reciprocal}
\end{figure}

Throughout this report we use the real-space primitive vectors
\[
\vec a_1 = \left( \tfrac{3}{2}a_{\mathrm{CC}},\;\tfrac{\sqrt{3}}{2}a_{\mathrm{CC}} \right),
\qquad
\vec a_2 = \left( \tfrac{3}{2}a_{\mathrm{CC}},\;-\tfrac{\sqrt{3}}{2}a_{\mathrm{CC}} \right),
\]
which span the triangular Bravais lattice underlying graphene.
The corresponding reciprocal vectors follow directly from inserting these expressions into the standard two-dimensional formulas
\[
\vec b_1 = 2\pi\,\frac{\hat z \times \vec a_2}{\vec a_1 \times \vec a_2},
\qquad
\vec b_2 = 2\pi\,\frac{\vec a_1 \times \hat z}{\vec a_1 \times \vec a_2}.
\]

For graphene these reciprocal vectors have equal magnitude,
\[
|\vec b_1| = |\vec b_2| = \frac{4\pi}{\sqrt{3}\,a_{\mathrm{CC}}},
\]
and form a hexagonal lattice rotated relative to the real-space one.
Each reciprocal lattice point corresponds to a spatial frequency of the honeycomb lattice.

When performing an FFT of an STM image, the bright peaks that appear correspond directly to these reciprocal lattice sites.
In particular, the six peaks forming a hexagon in the FFT occur at the magnitude
\[
|\vec b_1| = |\vec b_2|.
\]

Thus, the radius of the hexagon in the FFT is exactly the magnitude of the reciprocal lattice vector.
Solving the above relation for the carbon–carbon bond length yields
\begin{equation}
a_{\mathrm{CC}} = \frac{4\pi}{\sqrt{3}\,|\vec b_1|}.
\end{equation}

This expression provides a convenient way to extract the lattice spacing of graphite from experimental STM data.
By measuring the radius of the hexagon in the FFT image — that is, the distance from the center to any of the six bright peaks — and plugging it into the above expression, one directly obtains the real-space carbon–carbon distance.
In the analysis section we apply this method to our recorded images and compare the resulting value with the known literature value of $a_{\mathrm{CC}} = 1.42~\text{\AA}$.


\subsection{Piezoelectric Positioning and Feedback Control}

The precise positioning of the STM tip relative to the sample is achieved using a piezoelectric scanner.
Piezoelectric materials deform mechanically when an electric voltage is applied, allowing controlled motion with sub–ångström resolution.
In the tabletop STM used for this experiment, this is realized using a cylindrical piezoelectric tube, which enables motion of the tip in all three spatial directions.

\vspace{1em}
\begin{figure}[H]
    \centering
    \includegraphics[width=1.0\textwidth]{../resources/figures/piezo_tube.png}
    \caption{
        Principle of piezoelectric tube motion.
        (a) Tube with four segmented outer electrodes and a continuous inner electrode.
        (b) Equal voltage applied to all outer electrodes produces an extension along $z$.
        (c) Reversing the voltage causes contraction along $z$.
        (d) Applying opposite voltages to opposing outer electrodes bends the tube, resulting in lateral tip motion.
        The lateral motion follows an arc, which limits the usable scan range~\cite{ganguli2016thesis}.
    }
    \label{fig:piezo_tube}
\end{figure}

The piezo tube is coated with a continuous electrode on its inner surface and four separate electrodes on its outer surface, arranged in opposing pairs corresponding to the $x$ and $y$ directions, as shown in Fig.~\ref{fig:piezo_tube}a.
The STM tip is mounted at the free end of the tube, so any deformation of the tube directly translates into motion of the tip.

Vertical motion in the $z$ direction is achieved by applying a voltage between the inner and outer electrodes.
If the same voltage is applied uniformly, the tube expands or contracts along its axis (Fig.~\ref{fig:piezo_tube}b,c).
This axial deformation allows the tip–sample distance to be adjusted with extremely high precision and is used by the feedback loop to maintain a constant tunneling current during scanning.

Lateral motion in the $x$ and $y$ directions is produced by applying opposite voltages to pairs of outer electrodes.
For example, applying a positive voltage to one side of the tube and a negative voltage to the opposite side causes the tube to bend toward the negatively biased electrode (Fig.~\ref{fig:piezo_tube}d).
By combining voltages on different electrode pairs, controlled motion in both lateral directions is achieved, allowing the tip to raster-scan the sample surface.

An important consequence of this bending mechanism is that lateral motion does not occur along a perfectly straight line.
Instead, the tip follows a curved trajectory corresponding to an arc of a circle, as the tube bends rather than translating rigidly.
For small scan ranges this curvature is negligible, but for larger lateral displacements it becomes significant.
This geometric effect ultimately limits the maximum usable scan area of the STM and contributes to distortions at large scan sizes.

In practice, the motion of piezoelectric actuators is not perfectly linear or instantaneous.
When the applied voltage is changed, the resulting displacement depends slightly on the voltage history, a behavior known as \emph{hysteresis}.
In addition, after a sudden voltage change the piezo continues to deform slowly over time, an effect referred to as \emph{creep}.
Both effects lead to small distortions of the scan geometry, especially at larger scan sizes or during rapid changes in direction.

\subsubsection{Proportional and Integral Gain in the Feedback Loop}

In constant--current mode, the STM relies on a feedback loop to keep the tunneling current at a fixed setpoint by continuously adjusting the tip height.
The response of this feedback loop is controlled primarily by the proportional (P) and integral (I) gain parameters.

The proportional gain determines how strongly the controller reacts to an instantaneous deviation of the tunneling current from the setpoint.
If the measured current differs from the target value, the proportional term generates a correction voltage for the piezo in the $z$ direction that is directly proportional to this error.
A low proportional gain leads to a slow response, causing the tip to lag behind changes in surface height.
Conversely, a very high proportional gain can make the system overreact, resulting in oscillations or unstable tracking of the surface.

The integral gain accounts for the accumulated error over time.
If the current remains slightly above or below the setpoint for an extended period, the integral term gradually increases the correction until the steady-state error is eliminated.
This helps ensure accurate long-term tracking of the surface but can also slow down the response if chosen too large.

\vspace{1em}
\begin{figure}[H]
\centering
\includegraphics[width=1.0\textwidth]{../resources/figures/feedback_gain.png}
\caption{
Schematic illustration of the effect of feedback gain on STM imaging.
Low proportional gain leads to delayed tip response and loss of detail, while excessively high gain causes oscillations.
An intermediate gain allows stable tracking of surface features. Adapted from~\cite{wikimedia_pid_varying_p}.
}
\label{fig:feedback_gain}
\end{figure}

The effect of different proportional gain settings is illustrated schematically in Fig.~\ref{fig:feedback_gain}.
With too low gain, the tip fails to follow rapid height variations and smooths out surface features.
With excessively high gain, the feedback loop becomes unstable and introduces noise or oscillations into the image.
An intermediate gain provides stable tracking while still resolving atomic-scale features.

In this experiment the integral gain is kept fixed, while the proportional gain is adjusted to optimize image quality.
The influence of the proportional gain on image stability and resolution is discussed further in the results section.



% --- Experimental Setup ---
\section{Experimental Setup}

The STM used in this experiment is a custom-built instrument designed for operation under ambient conditions.
Its central component is a piezoelectric tube scanner, which enables precise positioning of the metallic tip relative to the sample in all three spatial directions.
A micrometer screw provides coarse manual approach, monitored using a USB microscope.
After this manual approach, a small stepper motor is attached to the micrometer screw, allowing a computer-controlled fine approach that brings the tip into the tunneling regime.
A schematic overview of the electronic setup and feedback loop is shown in Fig.~\ref{fig:stm_blockdiagram}.

A DC bias voltage is applied between the tip and the sample, defining the tunneling direction and the accessible energy range.
The resulting tunneling current, typically in the pA to nA range, is far too small to be processed directly.
It is therefore fed into a converter stage, where the current is transformed into a proportional voltage signal in the mV range.

Because the tunneling current depends exponentially on the tip--sample distance, this signal is further processed by a logarithmic amplifier, which linearizes the current–distance relationship.

The amplified signal is digitized and processed by the controller, which continuously compares the measured current to a user-defined setpoint.
Any deviation generates a control signal that adjusts the voltage applied to the $z$ electrode of the piezoelectric tube, thereby regulating the tip–sample distance.
Since piezoelectric actuators require large driving voltages, the controller output is amplified to voltages of up to $\pm200~\mathrm{V}$ before being applied to the scanner.

Lateral scanning is achieved independently of the feedback loop.
A scan generator produces time-dependent voltages for the $x$ and $y$ electrodes of the piezo tube, which are likewise amplified to $\pm200~\mathrm{V}$.

\vspace{1em}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{../resources/figures/STM_BlockDiagram.png}
\caption{Block diagram of the STM setup, showing the feedback loop, piezo scanner, and current amplification~\cite{STMAnleitung}.}
\label{fig:stm_blockdiagram}
\end{figure}

Data acquisition, control, and image processing are handled using the Nanotec electronics in combination with the WSxM software package.



% --- Procedure ---
\section{Procedure}

This section describes the measurement procedure as carried out according to the tasks (a)–(f) in the STM manual~\cite{STMAnleitung}.
All steps are written in the order in which they are performed during the experiment.

\subsection{(a) Tip Approach and Initial Parameters}

The graphite sample and the metallic tip are mounted in the STM head following the laboratory instructions.  
The tip is brought close to the surface using the coarse mechanical approach under visual control with the USB microscope.  
The automated fine approach is then started in WSxM until a tunneling current is detected.  
Once the tunneling current stabilizes, the feedback loop is activated and imaging mode begins.  
The initial scan parameters (scan size, speed, setpoint current, bias voltage, and feedback gains) are set to the default values recommended in the manual.

\subsection{(b) Feedback Optimization: Proportional and Integral Gain}

A small and slow scan is used to study the behavior of the feedback loop.  
The proportional gain $P$ is varied to observe how strongly the system responds to height deviations.  
The integral gain $I$ is adjusted to correct slow drift while avoiding oscillations.  
Different combinations of $P$ and $I$ are tested at various scan speeds to determine stable operating values.  
The goal is to identify parameter ranges that maintain a stable tunneling current without overshoot or noise.

\subsection{(c) Locating and Measuring Step Heights}

Larger-area scans are performed to locate terraces, steps, and grooves on the graphite surface.  
Suitable step edges are repeatedly scanned with moderate scan sizes to collect a series of step profiles.  
At least twenty step heights are measured using WSxM’s line profile tool and plane-correction filters.  
The measured step heights are plotted and compared with the graphite interlayer spacing of approximately \SI{3.35}{\angstrom}.  
From this comparison the effective $z$-piezo calibration (nominally \SI{10}{nm/V}) is estimated, including its uncertainty.

\subsection{(d) Achieving Atomic Resolution}

Regions that appear atomically flat in large scans are gradually zoomed in by reducing scan size and scan speed.  
The tunneling parameters are fine-tuned until atomic contrast becomes visible.  
Multiple atomic-resolution images are recorded with slightly different bias voltages and setpoint currents to ensure reproducibility.

\subsection{(e) Quantitative Analysis of Atomic Images}

Atomic-resolution images are analyzed using WSxM's line profile and measurement tools.  
The apparent corrugation height between bright and dark lattice sites is extracted.  
The lateral distance between neighboring maxima is measured along several high-symmetry directions.  
These values are compared to the known nearest-neighbor distance  of approximately \SI{1.42}{\angstrom}.  
The $x$/$y$ calibration factors of the piezo scanner are checked and, if necessary, adjusted.  
Angular relations between lattice directions are evaluated to identify possible distortions due to drift or scanner nonlinearity.

\subsection{(f) Fourier Analysis}

A two-dimensional Fast Fourier Transform (FFT) is applied to selected atomic-resolution images in WSxM.  
The resulting reciprocal‐space pattern is used to determine lattice periodicities and symmetry.  
FFT peak positions are compared with the real-space measurements to verify the consistency of the $x$/$y$ calibration.  
The FFT analysis also helps identify distortions such as shear, compression, or drift, which may affect the recorded images.



% --- Results ---
\section{Results}

\subsection{xxx}

xxx

\subsection{Quantitative Analysis of Atomic Images}
Atomic resolution could not be achieved during the experiment. A set of four bibliographical images taken by other groups in similar conditions with the same equipment were analyzed instead (Figure~\ref{fig:atomic_resolution}).

\begin{figure}[H]
    \centering
    \includegraphics[width=0.3\textwidth]{../resources/figures/Carbon_Bonding.png}
    \caption{Temporary image lol}
    \label{fig:atomic_resolution}
\end{figure}

Since only every second atom from the lattice is visualized in the image, the measured lattice constant $a$ corresponds to $a=\sqrt{3}a_{c-c}$, where $a_{c-c}$ is the nearest-neighbor distance of HOPG. The literature results of those measurements correspond to $a=2.46$\AA~and $a_{c-c}=1.42$\AA.

Our results measured an average value of $a=$\AA~in the \ang{120} direction, and $a=$\AA~in the \ang{60} direction.

If the values are different, that is the result of the thermal drift and piezo creep of the temperature at which the experiment was executed.


% --- Discussion ---
\section{Discussion}

\subsection{xxx}

xxx



% --- Conclusion ---
\section{Conclusion}

xxx



% --- Appendix ---
\newpage
\section{Appendix}

Additional files:

\begin{itemize}
  \item \texttt{"STM\_Python.zip"}
  \item \texttt{"STM\_LabReport.pdf"}
\end{itemize}



% --- References ---
\setstretch{1.0}
\printbibliography[heading=bibintoc]

\section*{Author's Note}
AI-based writing and programming tools were used in a supporting role to refine the wording of this report and to assist in formatting Python and LaTeX code.
All scientific analysis, data evaluation, and interpretation were carried out independently by the authors.



% --- Lab Report ---

\newpage
\includepdf[pages=-, scale=0.9, pagecommand={\thispagestyle{empty}}]{../resources/STM_LabReport.pdf}



\end{document}
